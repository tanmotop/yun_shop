(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8143"],{cR7k:function(e,t,a){},hrhA:function(e,t,a){"use strict";a.r(t);var r={name:"PlatformUserList",data:function(){return{search_form:{name:""},list:[],userList:[],userId:"",form:{type:1,username:""},pageSize:0,current_page:0,total:0,loading:!1,dialogTableVisible:!1,id:"",rules:{}}},created:function(){this.id=this.$route.params.id,this.currentChange(1)},destroyed:function(){},methods:{visDia:function(){this.dialogTableVisible=!0},currentChange:function(e){var t=this;this.loading=!0,$http.post("/admin/appuser",{uniacid:this.id,page:e,search:this.search_form},"加载中").then(function(e){1===e.result?(t.total=e.data.total,t.pageSize=e.data.per_page,t.userList=e.data.data,t.current_page=e.data.current_page):(t.list=e.data,t.$message.error("接口请求错误")),t.loading=!1}).catch(function(e){t.loading=!1,console.error(e)})},searchUser:function(e,t){var a=this;$http.post("/admin/appuser/checkname",{name:e,uniacid:this.id}).then(function(e){1===e.result?(a.list=[],e.data.forEach(function(e){a.list.push({value:e.username,id:e.uid})}),t(a.list)):a.$message.error(e.msg)}).catch(function(e){console.error(e)})},chooseUser:function(e){this.userId=e.id},addUser:function(){var e=this;$http.post("/admin/appuser/add",{uniacid:this.id,uid:this.userId,role:"manager"}).then(function(t){1===t.result?(e.$message.success(t.msg),e.currentChange(1),e.form.username="",e.dialogTableVisible=!1):e.$message.error(t.msg)}).catch(function(e){console.error(e)})},deleteUser:function(e){var t=this;$http.get("/admin/appuser/delete",{id:e}).then(function(e){1===e.result?(t.$message({type:"success",message:"删除成功!"}),t.currentChange(1)):t.$message.error(e.msg)}).catch(function(e){t.$message.error("删除失败!"),console.error(e)})},delRow:function(e){var t=this;this.$confirm("确定删除吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deleteUser(e.id)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},n=(a("kJNP"),a("ZrdR")),s=Object(n.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"right"},[a("div",{staticClass:"right-head"},[a("div",{staticClass:"right-head-con"},[e._v("使用者管理")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){e.visDia()}}},[e._v("添加使用者")])],1),e._v(" "),a("el-form",{ref:"search_form",attrs:{inline:!0,model:e.search_form}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.search_form.name,callback:function(t){e.$set(e.search_form,"name",t)},expression:"search_form.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:3,align:"right"}},[a("el-form-item",[a("el-button",{attrs:{type:"success",icon:"el-icon-search"},on:{click:function(t){e.currentChange(1)}}},[e._v("搜索\n          ")])],1)],1)],1)],1),e._v(" "),[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList}},[a("el-table-column",{attrs:{prop:"role_name",label:"权限",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"has_one_user.username",label:"用户名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger"},on:{click:function(a){e.delRow(t.row)}}},[e._v("删除\n          ")])]}}])})],1),e._v(" "),a("el-row",[a("el-col",{staticStyle:{padding:"15px 5% 15px 0"},attrs:{span:24,align:"right"}},[a("el-pagination",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{layout:"prev, pager, next","current-page":e.current_page,total:e.total,"page-size":e.pageSize,background:""},on:{"current-change":e.currentChange,"update:currentPage":function(t){e.current_page=t}}})],1)],1)],e._v(" "),a("el-dialog",{attrs:{title:"添加账号操作员/管理员",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"15%"}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-autocomplete",{staticStyle:{width:"75%"},attrs:{"fetch-suggestions":e.searchUser,"trigger-on-focus":!1,placeholder:"请输入用户名"},on:{select:e.chooseUser},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}}),e._v(" "),e.list.length<=0?a("div",{staticClass:"tip"},[e._v("\n          请输入完整的已有用户名\n          "),a("router-link",{staticStyle:{"padding-left":"10px",color:"#52d1ef"},attrs:{to:"/users/admin/add"}},[e._v("添加新用户\n          ")])],1):e._e()],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addUser()}}},[e._v("确 定")])],1)],1)],2)},[],!1,null,null,null);s.options.__file="user_list.vue";t.default=s.exports},kJNP:function(e,t,a){"use strict";var r=a("cR7k");a.n(r).a}}]);